
Sub AddBordersForMA()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim r As Long
    Dim i As Long
    
  
    Set ws = ThisWorkbook.Worksheets("工作表4") 
    
  
    lastRow = ws.Cells(ws.Rows.Count, 5).End(xlUp).Row     ' find E row
    
  
    For r = 1 To lastRow
       
        If ws.Cells(r, 5).Value = "MA" Then
       
            If r + 2 <= ws.Rows.Count Then

                With ws.Cells(r, 5).Borders(xlEdgeTop) ' MA Top black

                    .LineStyle = xlContinuous  
                    .Weight = xlThick          
                    .Color = RGB(0, 0, 0)      
                End With
                
                For i = r To r + 2                            ' MA and Next2 Black

                    With ws.Cells(i, 5).Borders(xlEdgeLeft)   'Left Black   
                        .LineStyle = xlContinuous  
                        .Weight = xlThick          
                        .Color = RGB(0, 0, 0)      
                    End With
                   
                    With ws.Cells(i, 5).Borders(xlEdgeRight)  ' Right Black
                        .LineStyle = xlContinuous  
                        .Weight = xlThick          
                        .Color = RGB(0, 0, 0)      
                    End With
                Next i
                
              
                With ws.Cells(r + 2, 5).Borders(xlEdgeBottom)  ' MA Bottom Black   
                    .LineStyle = xlContinuous 
                    .Weight = xlThick         
                    .Color = RGB(0, 0, 0)     
                End With
            End If
        End If
    Next r
    
End Sub
