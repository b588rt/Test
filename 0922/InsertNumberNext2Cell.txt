
Sub InsertMatchingRows()

    Dim ws4 As Worksheet
    Dim wsLS As Worksheet
    Dim i As Long
    Dim j As Long
    Dim batchValue As Variant
    Dim insertRow As Long
    Dim foundCount As Long
    Dim totalCount As Long 
    
    Set ws4 = ThisWorkbook.Worksheets("工作表4")
    Set wsLS = ThisWorkbook.Worksheets("工作表LS")
    
    totalCount = 0 
    
    For i = 500 To 2 Step -1
        If InStr(1, ws4.Cells(i, 5).Value, "Number", vbTextCompare) > 0 Then  'find "E" colum

            batchValue = ws4.Cells(i + 1, 5).Value    'set number next 2 cell

            insertRow = i + 2
            
            foundCount = 0 
            
            ' Match LS C2:C500
            For j = 2 To 500
                If wsLS.Cells(j, 3).Value = batchValue Then
               
                    ws4.Rows(insertRow).Insert Shift:=xlDown   'Copy & insert to cell 
                    wsLS.Rows(j).Copy
                    ws4.Rows(insertRow).PasteSpecial xlPasteAll
                    Application.CutCopyMode = False
                    
                    insertRow = insertRow + 1
                    foundCount = foundCount + 1
                    totalCount = totalCount + 1 
                End If
            Next j
            
            
        End If
    Next i
    
End Sub
